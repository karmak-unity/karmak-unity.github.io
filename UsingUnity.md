**Using Unity**



**Obtaining a Bearer Token**

Before making any calls to Unity API's, you must first obtain a Bearer Token,
which must be passed on each API request.

Unity uses OAuth 2.0 compatible access control, closely resembling the standard
"client_credentials" flow (grant type), with some additional information
required. 

Bearer Tokens (access tokens) are obtained using a properly formatted HTTPS
request, as detailed here:

| **HTTPS REQUEST**           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                     |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| Verb                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | POST                                                                                                                |
| **URL**                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                     |
| **Environment**             | **Notes**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | **Access Server URL**                                                                                               |
| QA                          | Not all customers have QA environments deployed -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | <https://qa.karmak.io/auth/connect/token>                                                                           |
|                             | use only if instructed by Karmak Support                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                     |
| Production                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | <https://api.karmak.io/auth/connect/token>                                                                          |
| **Headers**                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                     |
| **Header**                  | **Notes**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | **Value**                                                                                                           |
| Content-Type                | Must be URL-encoded in standard x-www-form-urlencoded format                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | application/x-www-form-urlencoded                                                                                   |
| **Body**                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                     |
| **Parameter**               | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | **Value**                                                                                                           |
| Client_ID                   | Unique Partner Identifier                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | *Please contact Karmak Partner Support for Client_ID; see Client_ID Notes below.*                                   |
| Client_Secret               | Partner Password                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | *Please contact Karmak Partner Support for Client_Secret*                                                           |
| Grant_Type                  | Must be exact value:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | karmak_identity                                                                                                     |
| Scope                       | Must be exact value:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | api                                                                                                                 |
| Account                     | ID representing the Karmak customer account being accessed                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | *Please contact Karmak Partner Support for Account ID*                                                              |
| User                        | User ID for the account being accessed; ties to a Fusion user                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | *Provided by Karmak Partner Support; see User notes below.*                                                         |
| **NOTES:**                  | **Client_ID:** The Client_ID (and associated Client_Secret) are issued by Karmak Support to customers or partners authorized to access Unity. The Client_ID uniquely identifies the partner or customer to which it is issued.  Partners use their Client_ID to authenticate, and specify using the Account and User parameters which customer to access. Customers accessing their own data will be issued their own Client_ID.  The Account and User parameters are still required. Client_ID's are only to be used by the party to whom they are issued.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                     |
|                             | Customers are not to provide Client_ID's issued to them to any third party without prior approval by Karmak.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                     |
|                             | If an additional separate Client_ID is needed for any reason, please contact Karmak Support.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                     |
|                             | **User:** The User ID referenced is within our Unity systems, and is not the same as a Fusion Username.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                     |
|                             | However, a Fusion username may be linked to a User ID - this step is necessary in order to access Fusion as the Fusion username.   As a part of initial setup Karmak Partner Support will:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                                     |
| **RESPONSE**                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                     |
| **Success**                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                     |
| **HTTP 200 (OK)**           | Body is JSON containing the Bearer Token to be used for access.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                     |
|                             | **Example 200 Response Body:**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                     |
|                             | {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                     |
|                             | "access_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IkRBRjAzMTk3QzgzNEFEODAxNjUxRjAwMjdEMUExQTFGRDM1NEUxQ0IiLCJ0eXAiOiJKV1QiLCJ4NXQiOiIydkF4bDhnMHJZQVdVZkFDZlJvYUg5TlU0Y3MifQ.eyJuYmYiOjE1NjE2NTkwOTUsImV4cCI6MTU2MTY2MjY5NSwiaXNzIjoiaHR0cDovL3dlYi5jb3JlYXV0aDo5MDI1IiwiYXVkIjpbImh0dHA6Ly93ZWIuY29yZWF1dGg6OTAyNS9yZXNvdXJjZXMiLCJhcGkiXSwiY2xpZW50X2lkIjoidG9ueV9jbGllbnQiLCJjbGllbnRfYWRtaW4iOiJhZG1pbiIsImNsaWVudF9zZWN1cml0eV9wcm9maWxlX2FjY291bnQiOiIwMDAwMDAwMS0wMDAxLTAwMDEtMDAwMS0wMDAwMDAwMDAwMDEiLCJjbGllbnRfc2VjdXJpdHlfcHJvZmlsZV91c2VyIjoiOGRhNTQ0Y2ItZDhkMC00ZTNjLTk4ZTQtYWY5Y2I3MGViMGY3Iiwic3ViIjoidG9ueV9jbGllbnQiLCJhdXRoX3RpbWUiOjE1NjE2NTkwOTUsImlkcCI6ImxvY2FsIiwiYWRtaW4iOiJhZG1pbiIsInNlY3VyaXR5X3Byb2ZpbGVfYWNjb3VudCI6IjAwMDAwMDAxLTAwMDEtMDAwMS0wMDAxLTAwMDAwMDAwMDAwMSIsInNlY3VyaXR5X3Byb2ZpbGVfdXNlciI6IjhkYTU0NGNiLWQ4ZDAtNGUzYy05OGU0LWFmOWNiNzBlYjBmNyIsImFjY291bnQiOiJhMTRmODRhZi1iM2ZiLTRhYzctYjYxMC0xY2YxOTJhNTVlZjYiLCJ1c2VyIjoiMmQ4OTQ0YTktNTRkMy00YThlLTlkMGItZDZiYzRjMTRiN2FiIiwic2NvcGUiOlsiYXBpIl0sImFtciI6WyJrYXJtYWsiXX0.n4QONtj3K4LV7ire8mGtb8KL7Py7Fsy-qYcuFC0nyVrE-JsJW4hCLehoZqwKR7B3Aj8LCORUbpdw0rcB1Emmq2IFjpouT5fE6v1SfieIAZIu6hWfsjhAgBm62wBg_9HjJeuf0B4tFu4KkKxBT4vzz-XRtHJoXLa7EH5qA4U9MCSo9qBgURHONnbH5a1oRL37QfAZ4uj3WRCpl6UlfoV966zfXcjrg-_7c7iOkVam1aNy2fZO8soSdTfhGluY1xWFF6snFS1-mt7iVh4kXIHVEsmJ93Ar9X7U0z6ksqRWv2Qs3c2cybSedeomy24R7bAF51JSCWP9jxkvjkd25t0Wvw",                                            |                                                                                                                     |
|                             | "expires_in": 3600,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                     |
|                             | "token_type": "Bearer"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                     |
|                             | }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                     |
|                             | **Using the Bearer Token**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                                     |
|                             | To make a request to an API, use the bearer token in the HTTP Authorization header.  Example:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                     |
|                             | Authorization:  Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkRBRjAzMTk3QzgzNEFEODAxNjUxRjAwMjdEMUExQTFGRDM1NEUxQ0IiLCJ0eXAiOiJKV1QiLCJ4NXQiOiIydkF4bDhnMHJZQVdVZkFDZlJvYUg5TlU0Y3MifQ.eyJuYmYiOjE1NjE2NTkwOTUsImV4cCI6MTU2MTY2MjY5NSwiaXNzIjoiaHR0cDovL3dlYi5jb3JlYXV0aDo5MDI1IiwiYXVkIjpbImh0dHA6Ly93ZWIuY29yZWF1dGg6OTAyNS9yZXNvdXJjZXMiLCJhcGkiXSwiY2xpZW50X2lkIjoidG9ueV9jbGllbnQiLCJjbGllbnRfYWRtaW4iOiJhZG1pbiIsImNsaWVudF9zZWN1cml0eV9wcm9maWxlX2FjY291bnQiOiIwMDAwMDAwMS0wMDAxLTAwMDEtMDAwMS0wMDAwMDAwMDAwMDEiLCJjbGllbnRfc2VjdXJpdHlfcHJvZmlsZV91c2VyIjoiOGRhNTQ0Y2ItZDhkMC00ZTNjLTk4ZTQtYWY5Y2I3MGViMGY3Iiwic3ViIjoidG9ueV9jbGllbnQiLCJhdXRoX3RpbWUiOjE1NjE2NTkwOTUsImlkcCI6ImxvY2FsIiwiYWRtaW4iOiJhZG1pbiIsInNlY3VyaXR5X3Byb2ZpbGVfYWNjb3VudCI6IjAwMDAwMDAxLTAwMDEtMDAwMS0wMDAxLTAwMDAwMDAwMDAwMSIsInNlY3VyaXR5X3Byb2ZpbGVfdXNlciI6IjhkYTU0NGNiLWQ4ZDAtNGUzYy05OGU0LWFmOWNiNzBlYjBmNyIsImFjY291bnQiOiJhMTRmODRhZi1iM2ZiLTRhYzctYjYxMC0xY2YxOTJhNTVlZjYiLCJ1c2VyIjoiMmQ4OTQ0YTktNTRkMy00YThlLTlkMGItZDZiYzRjMTRiN2FiIiwic2NvcGUiOlsiYXBpIl0sImFtciI6WyJrYXJtYWsiXX0.n4QONtj3K4LV7ire8mGtb8KL7Py7Fsy-qYcuFC0nyVrE-JsJW4hCLehoZqwKR7B3Aj8LCORUbpdw0rcB1Emmq2IFjpouT5fE6v1SfieIAZIu6hWfsjhAgBm62wBg_9HjJeuf0B4tFu4KkKxBT4vzz-XRtHJoXLa7EH5qA4U9MCSo9qBgURHONnbH5a1oRL37QfAZ4uj3WRCpl6UlfoV966zfXcjrg-_7c7iOkVam1aNy2fZO8soSdTfhGluY1xWFF6snFS1-mt7iVh4kXIHVEsmJ93Ar9X7U0z6ksqRWv2Qs3c2cybSedeomy24R7bAF51JSCWP9jxkvjkd25t0Wvw                                        |                                                                                                                     |
| **Failure / Error**         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                     |
| **HTTP 401 (Unauthorized)** | JSON in body of response can help to diagnose the cause of the failure.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                     |
|                             | **Returned data**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | **Cause**                                                                                                           |
|                             | {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | The Client_ID is not recognized                                                                                     |
|                             | "error": "invalid_client"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                     |
|                             | }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                     |
|                             | {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | The Client_ID is recognized, but the Partner or Customer is not authorized to access the specified User or Account. |
|                             | "error": "invalid_grant",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                     |
|                             | "error_description": "You do not have permission to use that Identity."                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                     |
|                             | }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                     |
|                             | **Notes**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                     |
|                             | Credentials for QA environment will not work in Production environment, and vice versa.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                     |

-    Create a new Fusion service username within the customer's Fusion system
    that represents the Partner or customer Unity access.

-    Create a Unity User that is associated with this Fusion service username.

-    Provide the Unity User ID to the Partner or customer.

If the partner provides services to multiple Karmak customers, the above process
will be completed for each customer Account.

Multiple Users 

-   A Client_ID can access multiple Account/User combinations (i.e., one Partner
    can make API requests to multiple Karmak customer Accounts).

-   A separate token must be obtained for each Account/User combination needed.

-   A single Account can support multiple Users for the Account

-   At the User level, there is a 1:1 relationship with Fusion usernames (i.e.,
    one User can only be associated with one Fusion username)

-   Please contact Karmak Partner Support for additional Users and provide the
    Fusion username to which the User will be tied.

-   By tying the User to a Fusion username, the User passed into the API will
    then operate as the Fusion username.

-   No refresh tokens are provided (currently)

-   Tokens contain expiration (currently one hour), after which time a new token
    must be requested.

-   The Client_ID is recognized, but the Client_Secret is invalid

-   Note that the bearer token value to be provided in the Authorization
    header *does not* include the quotes

-   Contact Karmak Partner Support if you are unable to resolve the issue.

**Making the API Request**

The base URL for all Unity API calls is as follows:

-   https://api.karmak.io/api/unity/{version}/unityapi/

-   See API documentation for specific URL requests
